import{a,r as l,o as e,k as n,l as s,m as t,w as o,b as u,t as c,n as i,z as r,D as v,F as d,s as p,q as m,e as f,v as b}from"./vendor-vue-IgQ0LSVQ.js";import{a as g}from"./ancestralService-CknlIkj1.js";import{u as y}from"./notificationStore-Dw0I-Rqg.js";import{_ as k}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./index-iiR0jBps.js";const _={class:"container-fluid py-4"},h={class:"d-flex justify-content-between align-items-center mb-3"},w={key:0,class:"alert alert-info"},I={key:1,class:"alert alert-danger"},j={key:2},x={class:"mb-3"},C=["value"],N={class:"grid-container"},P=["onClick"],q={class:"cell-content"},D={key:0,class:"occupant"},S={key:0,class:"mt-4 card"},V={class:"card-body"},z={class:"btn-group"},F=k(a({__name:"IndexView",setup(a){const k=y(),F=l(!1),U=l(null),$=l([]),A=l(null),B=l("甲區"),E=l(["甲區","乙區","丙區","丁區","中區"]);async function G(){F.value=!0,U.value=null;try{const{data:a}=await g.query({section:B.value});$.value=a.data||[]}catch(a){U.value=(null==a?void 0:a.message)||"加載失敗"}finally{F.value=!1}}async function H(){if(A.value&&confirm("確定要刪除此牌位嗎？"))try{await g.delete(A.value.ancestralPositionId),k.success("牌位已刪除"),await G(),A.value=null}catch(a){k.error((null==a?void 0:a.message)||"刪除失敗")}}return e(()=>G()),(a,l)=>{const e=u("router-link");return f(),n("div",_,[s("div",h,[l[2]||(l[2]=s("h2",null,"陳氏宗祠-牌位清單",-1)),t(e,{to:"/app/ancestral/add",class:"btn btn-primary"},{default:o(()=>[...l[1]||(l[1]=[m("新增牌位",-1)])]),_:1})]),F.value?(f(),n("div",w,"加載中...")):U.value?(f(),n("div",I,c(U.value),1)):(f(),n("div",j,[s("div",x,[l[3]||(l[3]=s("label",{class:"form-label"},"選擇區域",-1)),r(s("select",{"onUpdate:modelValue":l[0]||(l[0]=a=>B.value=a),class:"form-select",onChange:G},[(f(!0),n(d,null,p(E.value,a=>(f(),n("option",{key:a,value:a},c(a),9,C))),128))],544),[[v,B.value]])]),s("div",N,[(f(!0),n(d,null,p($.value,a=>(f(),n("div",{key:a.ancestralPositionId,class:b(["grid-cell",{occupied:a.occupantName}]),onClick:l=>function(a){A.value=a}(a)},[s("div",q,[s("small",null,c(a.section)+"-"+c(a.level)+"-"+c(a.position),1),a.occupantName?(f(),n("div",D,c(a.occupantName),1)):i("",!0)])],10,P))),128))]),A.value?(f(),n("div",S,[l[11]||(l[11]=s("div",{class:"card-header"},"位置詳情",-1)),s("div",V,[s("p",null,[l[4]||(l[4]=s("strong",null,"位置ID:",-1)),m(" "+c(A.value.ancestralPositionId),1)]),s("p",null,[l[5]||(l[5]=s("strong",null,"區域:",-1)),m(" "+c(A.value.section),1)]),s("p",null,[l[6]||(l[6]=s("strong",null,"層級:",-1)),m(" "+c(A.value.level),1)]),s("p",null,[l[7]||(l[7]=s("strong",null,"位置:",-1)),m(" "+c(A.value.position),1)]),s("p",null,[l[8]||(l[8]=s("strong",null,"佔用者:",-1)),m(" "+c(A.value.occupantName||"未佔用"),1)]),s("p",null,[l[9]||(l[9]=s("strong",null,"電話:",-1)),m(" "+c(A.value.phone||"-"),1)]),s("div",z,[t(e,{to:`/ancestral/edit/${A.value.ancestralPositionId}`,class:"btn btn-warning btn-sm"},{default:o(()=>[...l[10]||(l[10]=[m("編輯",-1)])]),_:1},8,["to"]),s("button",{class:"btn btn-danger btn-sm",onClick:H},"刪除")])])])):i("",!0)]))])}}}),[["__scopeId","data-v-239d0d64"]]);export{F as default};
