import{a as l,r as a,o as e,k as s,l as n,m as o,w as t,b as u,t as c,n as i,z as r,D as d,F as v,s as m,q as p,e as f,v as k}from"./vendor-vue-IgQ0LSVQ.js";import{k as b}from"./kindnessService-B1VP09PC.js";import{u as g}from"./notificationStore-Dw0I-Rqg.js";import{_ as y}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./index-C6TQgNXw.js";const w={class:"container-fluid py-4"},_={class:"d-flex justify-content-between align-items-center mb-3"},h={key:0,class:"alert alert-info"},I={key:1,class:"alert alert-danger"},j={key:2},x={class:"row mb-3"},C={class:"col-md-3"},N=["value"],P={class:"col-md-3"},V=["value"],q={class:"grid-container"},D=["onClick"],F={class:"cell-content"},S={key:0,class:"occupant"},U={key:0,class:"mt-4 card"},z={class:"card-body"},$={class:"btn-group"},A=y(l({__name:"IndexView",setup(l){const y=g(),A=a(!1),B=a(null),E=a([]),G=a(null),H=a(1),J=a("甲區"),K=a([1,2,3]),L=a(["甲區","乙區","丙區","丁區","戊區","己區"]);async function M(){A.value=!0,B.value=null;try{const{data:l}=await b.query({floor:H.value,section:J.value});E.value=l.data||[]}catch(l){B.value=(null==l?void 0:l.message)||"加載失敗"}finally{A.value=!1}}async function O(){if(G.value&&confirm("確定要刪除此塔位嗎？"))try{await b.delete(G.value.kindnessPositionId),y.success("塔位已刪除"),await M(),G.value=null}catch(l){y.error((null==l?void 0:l.message)||"刪除失敗")}}return e(()=>M()),(l,a)=>{const e=u("router-link");return f(),s("div",w,[n("div",_,[a[3]||(a[3]=n("h2",null,"懷恩塔-塔位清單",-1)),o(e,{to:"/app/kindness/add",class:"btn btn-primary"},{default:t(()=>[...a[2]||(a[2]=[p("新增塔位",-1)])]),_:1})]),A.value?(f(),s("div",h,"加載中...")):B.value?(f(),s("div",I,c(B.value),1)):(f(),s("div",j,[n("div",x,[n("div",C,[a[4]||(a[4]=n("label",{class:"form-label"},"選擇樓層",-1)),r(n("select",{"onUpdate:modelValue":a[0]||(a[0]=l=>H.value=l),class:"form-select",onChange:M},[(f(!0),s(v,null,m(K.value,l=>(f(),s("option",{key:l,value:l},c(l)+"樓",9,N))),128))],544),[[d,H.value]])]),n("div",P,[a[5]||(a[5]=n("label",{class:"form-label"},"選擇區域",-1)),r(n("select",{"onUpdate:modelValue":a[1]||(a[1]=l=>J.value=l),class:"form-select",onChange:M},[(f(!0),s(v,null,m(L.value,l=>(f(),s("option",{key:l,value:l},c(l),9,V))),128))],544),[[d,J.value]])])]),n("div",q,[(f(!0),s(v,null,m(E.value,l=>(f(),s("div",{key:l.kindnessPositionId,class:k(["grid-cell",{occupied:l.occupantName}]),onClick:a=>function(l){G.value=l}(l)},[n("div",F,[n("small",null,c(l.floor)+"F-"+c(l.row)+"-"+c(l.column),1),l.occupantName?(f(),s("div",S,c(l.occupantName),1)):i("",!0)])],10,D))),128))]),G.value?(f(),s("div",U,[a[13]||(a[13]=n("div",{class:"card-header"},"位置詳情",-1)),n("div",z,[n("p",null,[a[6]||(a[6]=n("strong",null,"位置ID:",-1)),p(" "+c(G.value.kindnessPositionId),1)]),n("p",null,[a[7]||(a[7]=n("strong",null,"樓層:",-1)),p(" "+c(G.value.floor)+"樓",1)]),n("p",null,[a[8]||(a[8]=n("strong",null,"區域:",-1)),p(" "+c(G.value.section),1)]),n("p",null,[a[9]||(a[9]=n("strong",null,"列:",-1)),p(" "+c(G.value.row),1)]),n("p",null,[a[10]||(a[10]=n("strong",null,"欄:",-1)),p(" "+c(G.value.column),1)]),n("p",null,[a[11]||(a[11]=n("strong",null,"佔用者:",-1)),p(" "+c(G.value.occupantName||"未佔用"),1)]),n("div",$,[o(e,{to:`/kindness/edit/${G.value.kindnessPositionId}`,class:"btn btn-warning btn-sm"},{default:t(()=>[...a[12]||(a[12]=[p("編輯",-1)])]),_:1},8,["to"]),n("button",{class:"btn btn-danger btn-sm",onClick:O},"刪除")])])])):i("",!0)]))])}}}),[["__scopeId","data-v-38547cab"]]);export{A as default};
