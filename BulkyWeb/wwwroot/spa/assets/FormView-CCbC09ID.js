import{a,r as e,E as l,y as s,o as t,k as n,l as o,t as i,n as r,z as c,A as m,v as d,m as u,q as p,w as v,b,B as y,e as f,p as h}from"./vendor-vue-IgQ0LSVQ.js";import{c as x,a as k}from"./index.esm-nxtYy_By.js";import{c as j}from"./crudService-BHQG69IU.js";import{u as g}from"./notificationStore-Dw0I-Rqg.js";import{_ as w}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./index-rv2ZoWvM.js";const _={class:"container py-4",style:{"max-width":"600px"}},V={class:"mb-3"},U={key:0,class:"invalid-feedback"},E={class:"mb-3"},I={class:"mb-3"},O={class:"mb-3"},S={class:"mb-3"},q={key:0,class:"invalid-feedback"},B={key:0,class:"alert alert-danger"},z={class:"d-flex gap-2"},A=["disabled"],F={key:0,class:"spinner-border spinner-border-sm me-2"},N=w(a({__name:"FormView",setup(a){const w=h(),N=l(),C=g(),D=j("/company"),G=e(!1),H=e(null),J=e(!!N.params.id),K=s({name:"",address:"",city:"",phone:"",email:""}),L=s({}),M=x({name:k().required("名稱為必填"),email:k().email("請輸入有效的電郵")});async function P(){H.value=null;if(await async function(){try{return await M.validate(K,{abortEarly:!1}),Object.keys(L).forEach(a=>delete L[a]),!0}catch(a){if(Object.keys(L).forEach(a=>delete L[a]),a.inner)for(const e of a.inner)e.path&&(L[e.path]=e.message);return!1}}()){G.value=!0;try{J.value&&K.companyId?(await D.update(K.companyId,K),C.success("宗親會已更新")):(await D.create(K),C.success("宗親會已新增")),w.push("/app/company")}catch(a){H.value=(null==a?void 0:a.message)||"操作失敗"}finally{G.value=!1}}}return t(async()=>{if(J.value&&N.params.id)try{const{data:a}=await D.getById(Number(N.params.id));Object.assign(K,a.data)}catch(a){H.value=(null==a?void 0:a.message)||"加載失敗"}}),(a,e)=>{const l=b("router-link");return f(),n("div",_,[o("h2",null,i(J.value?"編輯宗親會":"新增宗親會"),1),o("form",{onSubmit:y(P,["prevent"]),novalidate:""},[o("div",V,[e[5]||(e[5]=o("label",{class:"form-label"},"名稱",-1)),c(o("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>K.name=a),type:"text",class:d(["form-control",{"is-invalid":L.name}])},null,2),[[m,K.name]]),L.name?(f(),n("div",U,i(L.name),1)):r("",!0)]),o("div",E,[e[6]||(e[6]=o("label",{class:"form-label"},"地址",-1)),c(o("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>K.address=a),type:"text",class:"form-control"},null,512),[[m,K.address]])]),o("div",I,[e[7]||(e[7]=o("label",{class:"form-label"},"城市",-1)),c(o("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>K.city=a),type:"text",class:"form-control"},null,512),[[m,K.city]])]),o("div",O,[e[8]||(e[8]=o("label",{class:"form-label"},"電話",-1)),c(o("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>K.phone=a),type:"tel",class:"form-control"},null,512),[[m,K.phone]])]),o("div",S,[e[9]||(e[9]=o("label",{class:"form-label"},"電郵",-1)),c(o("input",{"onUpdate:modelValue":e[4]||(e[4]=a=>K.email=a),type:"email",autocomplete:"email",class:d(["form-control",{"is-invalid":L.email}])},null,2),[[m,K.email]]),L.email?(f(),n("div",q,i(L.email),1)):r("",!0)]),H.value?(f(),n("div",B,i(H.value),1)):r("",!0),o("div",z,[o("button",{class:"btn btn-primary",disabled:G.value},[G.value?(f(),n("span",F)):r("",!0),p(" "+i(J.value?"更新":"新增"),1)],8,A),u(l,{to:"/app/company",class:"btn btn-secondary"},{default:v(()=>[...e[10]||(e[10]=[p("返回",-1)])]),_:1})])],32)])}}}),[["__scopeId","data-v-9c177b2c"]]);export{N as default};
